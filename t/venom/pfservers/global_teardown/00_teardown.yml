name: Global teardown
testcases:
- name: delete_access_level
  steps:
  - type: http
    method: DELETE
    url: '{{.pfserver_webadmin_url}}/api/v1/config/admin_role/{{.access_level_user_and_node.id}}'
    ignore_verify_ssl: true
    headers:
      "Authorization": "{{.pfserver_token}}"
      "Content-Type": "application/json"
    assertions:
      - result.statuscode ShouldEqual 200
  
- name: delete_switch
  steps:
  - type: http
    method: DELETE
    url: '{{.pfserver_webadmin_url}}/api/v1/config/switch/{{.cumulus_switch.id}}'
    ignore_verify_ssl: true
    headers:
      "Authorization": "{{.pfserver_token}}"
      "Content-Type": "application/json"
    assertions:
      - result.statuscode ShouldEqual 200

- name: delete_switch_group
  steps:
  - type: http
    method: DELETE
    url: '{{.pfserver_webadmin_url}}/api/v1/config/switch_group/{{.cumulus_switch_group.id}}'
    ignore_verify_ssl: true
    headers:
      "Authorization": "{{.pfserver_token}}"
      "Content-Type": "application/json"
    assertions:
      - result.statuscode ShouldEqual 200

- name: delete_nodes
  steps:
    - type: http
      method: DELETE
      url: '{{.pfserver_webadmin_url}}/api/v1/node/aa%3Aaa%3Aaa%3Abb%3Abb%3A11'
      ignore_verify_ssl: true
      headers:
        "Authorization": "{{.pfserver_token}}"
        "Content-Type": "application/json"
      assertions:
        - result.statuscode ShouldEqual 200

- name: Delete internal source
  steps:
  - type: http
    method: DELETE
    url: '{{.pfserver_webadmin_url}}/api/v1/config/source/{{.id_internal_sources}}'
    ignore_verify_ssl: true
    headers:
      "Authorization": "{{.pfserver_token}}"
      "Content-Type": "application/json"
    assertions:
      - result.statuscode ShouldEqual 200

- name: Delete external source
  steps:
  - type: http
    method: DELETE
    url: '{{.pfserver_webadmin_url}}/api/v1/config/source/{{.id_external_sources}}'
    ignore_verify_ssl: true
    headers:
      "Authorization": "{{.pfserver_token}}"
      "Content-Type": "application/json"
    assertions:
      - result.statuscode ShouldEqual 200

- name: Delete exclusive source
  steps:
  - type: http
    method: DELETE
    url: '{{.pfserver_webadmin_url}}/api/v1/config/source/{{.id_exclusive_sources}}'
    ignore_verify_ssl: true
    headers:
      "Authorization": "{{.pfserver_token}}"
      "Content-Type": "application/json"
    assertions:
      - result.statuscode ShouldEqual 200

- name: delete_users
  steps:
    - type: http
      method: DELETE
      url: '{{.pfserver_webadmin_url}}/api/v1/user/{{.create_user}}'
      ignore_verify_ssl: true
      headers:
        "Authorization": "{{.pfserver_token}}"
        "Content-Type": "application/json"
      assertions:
        - result.statuscode ShouldEqual 200
